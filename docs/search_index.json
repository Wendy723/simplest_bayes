[
["index.html", "Simplest Bayesian Example Welcome", " Simplest Bayesian Example Devin Pastoor Welcome An extremely simple example of modeling and postprocessing a bayesian dataset with nonmem "],
["dataset-creation.html", "1 Dataset Creation 1.1 Generate data for mrgsolve 1.2 Model Details 1.3 Predicted Profiles", " 1 Dataset Creation library(knitr) library(PKPDmisc) library(tidyverse) library(mrgsolve) source(&quot;../scripts/model_details.R&quot;) models &lt;- source(&quot;../models/models.R&quot;)$value #&gt; model dir set to C:/Users/devin/Documents/Repos/simplest_bayes/models #&gt; cache location set to C:\\Users\\devin\\Documents\\Repos\\simplest_bayes\\models\\.modelcache #&gt; Loading model from cache. 1.1 Generate data for mrgsolve start with a baseline of having 50 individuals worth of data, can scale to different amounts of individuals later NIDS &lt;- 50 demogs &lt;- data_frame(ID = 1:NIDS) for_dosing &lt;- demogs %&gt;% mutate( CMT = 1, EVID = 1, TIME = 0, AMT = 1000, RATE = 1000 ) one_cmt_iv &lt;- models$use(&quot;one_cmt_iv&quot;) 1.2 Model Details mrgsolve::see(one_cmt_iv) #&gt; #&gt; Model file: one_cmt_iv.cpp #&gt; [PARAM] @annotated #&gt; CL : 4 : Clearance (L/hr) #&gt; V : 35 : Volume (L) #&gt; #&gt; #&gt; [CMT] @annotated #&gt; CENT : Central compartment (mg) #&gt; #&gt; [PKMODEL] #&gt; ncmt=1, trans=11 #&gt; #&gt; [MAIN] #&gt; double CLi = CL*exp(nCL); #&gt; double Vi = V*exp(nV); #&gt; #&gt; #&gt; [OMEGA] @annotated @correlation @block #&gt; nCL : 0.1 : Random effect on CL #&gt; nV : 0.4 0.04 : Random effect on V #&gt; #&gt; [SIGMA] @annotated #&gt; PROP : 0.04 : Proportional error #&gt; // so don&#39;t get into issues with estimating via multiplicative error only #&gt; ADD : 0.5 : Additive residual error #&gt; #&gt; [TABLE] #&gt; double IPRED = CENT/Vi; #&gt; double DV = CENT/Vi*(1+PROP) + ADD; #&gt; #&gt; [CAPTURE] @annotated #&gt; DV : plasma concentration (mg/L) #&gt; IPRED : Individual predicted plasma concentration (mg/L) #&gt; CLi : Individual Clearance (L/hr) #&gt; Vi : Individual Volume (L) one_cmt_iv %&gt;% model_details %&gt;% filter(block != &quot;CAPTURE&quot;) %&gt;% kable() block name descr unit options value PARAM CL Clearance L/hr . 4.00 PARAM V Volume L . 35.00 CMT CENT Central compartment mg . 0.00 OMEGA nCL Random effect on CL . . 0.10 OMEGA nV Random effect on V . . 0.04 SIGMA PROP Proportional error . . 0.04 SIGMA ADD Additive residual error . . 0.50 simulated_data &lt;- one_cmt_iv %&gt;% data_set(for_dosing) %&gt;% mrgsim(end = 24, delta = 0.25) %&gt;% as_data_frame 1.3 Predicted Profiles simulated_data %&gt;% filter(IPRED &gt; 0.1) %&gt;% ggplot(aes(x = TIME, y = IPRED, group = ID)) + geom_line(size = 1.05, alpha = 0.8) + theme_bw() + base_theme() + scale_y_log10() sample_times &lt;- c(1, 2, 4, 8, 16, 24) LLOQ &lt;- 0.1 sampled_data &lt;- simulated_data %&gt;% filter(TIME %in% sample_times, DV &gt; LLOQ) list_plots &lt;- sampled_data %&gt;% mutate(PNUM = ids_per_plot(ID)) %&gt;% split(.$PNUM) %&gt;% map(~ ggplot(., aes(x = TIME, y = IPRED, group = ID)) + geom_point(aes(y = DV), color = &quot;blue&quot;) + geom_line(size = 1.05, alpha = 0.8) + theme_bw() + base_theme() + facet_wrap(~ID) + scale_y_log10() ) print_plots(list_plots) #&gt; [[1]] #&gt; NULL #&gt; #&gt; [[2]] #&gt; NULL #&gt; #&gt; [[3]] #&gt; NULL #&gt; #&gt; [[4]] #&gt; NULL #&gt; #&gt; [[5]] #&gt; NULL #&gt; #&gt; [[6]] #&gt; NULL devtools::session_info() #&gt; Session info -------------------------------------------------------------- #&gt; setting value #&gt; version R version 3.3.2 (2016-10-31) #&gt; system x86_64, mingw32 #&gt; ui RTerm #&gt; language (EN) #&gt; collate English_United States.1252 #&gt; tz America/New_York #&gt; date 2016-12-06 #&gt; Packages ------------------------------------------------------------------ #&gt; package * version date #&gt; assertthat 0.1 2013-12-06 #&gt; backports 1.0.4 2016-10-24 #&gt; bookdown 0.2 2016-11-12 #&gt; codetools 0.2-15 2016-10-05 #&gt; colorspace 1.2-7 2016-10-11 #&gt; DBI 0.5-1 2016-09-10 #&gt; devtools 1.12.0 2016-06-24 #&gt; digest 0.6.10 2016-08-02 #&gt; dplyr * 0.5.0 2016-06-24 #&gt; evaluate 0.10 2016-10-11 #&gt; ggplot2 * 2.1.0.9001 2016-11-07 #&gt; gtable 0.2.0 2016-02-26 #&gt; highr 0.6 2016-05-09 #&gt; htmltools 0.3.5 2016-03-21 #&gt; httpuv 1.3.3 2015-08-04 #&gt; knitr * 1.15 2016-11-09 #&gt; labeling 0.3 2014-08-23 #&gt; lazyeval 0.2.0 2016-06-12 #&gt; magrittr 1.5 2014-11-22 #&gt; memoise 1.0.0 2016-01-29 #&gt; mime 0.5 2016-07-07 #&gt; miniUI 0.1.1 2016-01-15 #&gt; mrgsolve * 0.7.6.9029 2016-12-06 #&gt; munsell 0.4.3 2016-02-13 #&gt; overseer * 0.0.1 2016-12-06 #&gt; PKPDmisc * 0.4.4.9000 2016-11-02 #&gt; plyr 1.8.4 2016-06-08 #&gt; purrr * 0.2.2 2016-06-18 #&gt; R6 2.2.0 2016-10-05 #&gt; Rcpp 0.12.8 2016-11-17 #&gt; RcppArmadillo 0.7.500.0.0 2016-10-22 #&gt; readr * 1.0.0 2016-08-03 #&gt; rmarkdown 1.2 2016-11-21 #&gt; rprojroot 1.1 2016-10-29 #&gt; scales 0.4.0.9003 2016-11-07 #&gt; shiny 0.14.2 2016-11-01 #&gt; stringi 1.1.2 2016-10-01 #&gt; stringr 1.1.0 2016-08-19 #&gt; tibble * 1.2 2016-08-26 #&gt; tidyr * 0.6.0 2016-08-12 #&gt; tidyverse * 1.0.0 2016-09-09 #&gt; withr 1.0.2 2016-06-20 #&gt; xtable 1.8-2 2016-02-05 #&gt; yaml 2.1.13 2014-06-12 #&gt; source #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; Github (hadley/ggplot2@70c3d69) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; Github (metrumresearchgroup/mrgsolve@d92f31a) #&gt; CRAN (R 3.3.2) #&gt; local #&gt; Github (dpastoor/PKPDmisc@beae2a6) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; Github (hadley/scales@d58d83a) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) "]
]
